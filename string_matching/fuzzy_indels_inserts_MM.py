#!/usr/bin/env python
# coding: utf-8
from fuzzysearch import find_near_matches
from Bio.Seq import Seq
from Bio.Alphabet import IUPAC
from collections import defaultdict
import collections

f_in = open("parent_list.txt", "r")
count = 0
wanted = set("""YPVEIHEY
LPWKAFTY
FPMEIRQY
HEMVVYEA
GEYKIMVA
SETKIFTA
SETKVFTA
GETIFVTA
GEVLMVQV
HFDMAVYL
YSIRPLIV
AYLESFYKF
KYPSPFFVF
VYMDWYEKF
FYMDTSHLF
AYMPHTFFI
VYNSEYYHF
KYMDVQFDF
EYMEHVYLI
LYPLTNYTF
YYLNEIQSF
IYGYVAEQF
SYMGHFDLL
YYIFIPSKF
AYPEYLITF
RYLTVAAVF
QYPVIIHLI
VYGPLPQSF
YWMHVQNTF
EYQKVWNLF
AYPHNLMTF
YYQNYFEKL
IYVHDLLTF
RYLEQLHQL
RYPDSHQLF
VYVQHPITF
IYMPMIPEL
KYTKIFNDF
YYMIGEQKF
PYMAKFVVF
RYLTVATVF
RFEEAHFTF
VYISEHEHF
NYLSIFRKF
NYSPYVNYF
VYLPNINKI
RYPDRITLI
NYISGIQTI
KYLGQLHYL
LYTEKFEEF
KYQIINEEF
KYIEGVSDF
SYIALPLTL
SYADQMFLL
RYATQLQQI
YYDKHFTEF
GYSEHFVEF
RYFSTSVSW
YYTDIMHTL
KYDEIFYNL
KYQEVTNNL
AYVHMVTHF
KYPDRVPVI
WYQTKFETL
VYQNHVQHL
VYHHLVETL
VYIKHPVSL
TYIPVPAKI
TYAEKLHRL
TYLDKVENI
YYEKLHTYF
TYTDRVFFL
YYTPITPHL
TYLEKAIKI
VYVQNVVKL
IYAPPLPSL
KSFEGLFYF
KFIDTTSKF
IYTSSVNRL
RYALQMEQL
KYTPPPHHI
SYTSGLETL
KYIHSANVL
KYSLIKGNF
VYDVVELKF
AYINKVEEL
QYDEAVAQF
IYDLATQTL
VFTSRSAAF
VMAPRTLLL
YYDVAKQLL
VFDIHVIDF
TYGEIFEKF
AYLEAIHNF
KYMDINFDF
LYPSIIQEF
QYMELFNKI
IYIKQIKTF
RYQFIEEAF
SYNPLWLRI
KYAMMFAEL
LYANMFERL
NYLLYVSNF
LYIVEPLKF
FYPYGLQTF
RYLNEFEEL
VYTVVDEMF
FYNLLTRTF
IYLEKLKTI
TYQDIQNTI
GYPLWKVTF
NYLDRFLSL
LYLPSFFTY
SYDPDFNQL
IYIKHPHLF
SYQKVIELF
KYPENFFLL
YYPAGTQLF
AYSRVQYQF
SYNNFFRMF
VLPDMFFSF
IYIWDLNNF
NYSNIRFQF
SYSHIMALI
RYLEKPMEI
SYIPIFPQL
NYLSHHLTI
AYIERMNYI
PYNDYFEYF
SYIPLFPQL
KYQDILNEI
VYSLQQFGF
VFTYVGALF
KYFEKQFEL
RYLDWIKKI
NYAQVFNKL
RYQTQPVTL
AYVLNIVRF
TYPAELNNI
GYIERPQLI
QYNPKFQTL
AYLLNLNHL
AYALLLQHL
QYNPHVHQL
IWDETPLYF
LYDIILKNF
IYLTFPVAM
FAFEHSEEY
MPTVSVLEY
FPSIYDVKY
HPMSEYPTY
MPADTNKAF
MAWLVDHVY
LPYNHQHEY
LPMGVVVDY
FPVIYDVKY
LPDEIYHVY
LPAKILVEF
HPTVVISAY
MPAVKAIIY
FPVGDVNNF
FPNAIEHTL
FPLDLDVKM
YPDRIMNTF
EAASVPVVY
HAANQSYQY
LPESTHVEF
VPASLPVEF
HPIQTQAQY
EAFLNNQEY
SPVDSVLFY
NPVQALSEF
IPVLIFQAY
SPVESVLFY
VAAPEHISY
NPWDNKAVY
LPWVGKELY
IPNEIIHAL
TAAAVGAVF
KPIESFNEY
RPAPVEVTY
LPVIIFTTF
YPVEIHEYL
NAFEVAEKY
QAIEDMVGY
FPEEDKKTY
MPQGGGQHY
MADPKGKAY
NAWTALETY
LPFDKETGF
EVYAGSHQY
TAFDVAEKY
IPVTIITGY
TAMDVVYAL
TPAGVVNKY
IPTRVVTNY
NVIRDAVTY
TPALIALRY
TVFDLVEEY
IPFRPSIQF
VPLDERIVF
HVIDVKFLY
LPEELARMY
SPEEGARVY
NAFKEITTM
EVLWPLPAY
VPHSIINGY
SAMEVVPAL
NAQRQDIAF
VPNKVIQCF
EATKAVTEM
FPNIPGKSL
TVSDAILRY
DPFIDLNYM
DAYPEIEKF
TVTEVLLKY
TAIEKVVQM
SVSEVIEGY
NTDEPPMVF
HAVPAGNTV
SAMMHALEV
FPMTMDEKY
YPVKEFEVY
FPQLDSTSF
EALDHMVEY
SPFEFGFTF
IPAAVKLTY
MPMGPDQKY
MANIPLPEY
LPQHTIETY
HAFVELHEF
HAHVDKVTY
FPEIDLEKY
TAIRALETY
NVIHNLATY
DAFAEWTEM
NAITLPEEF
DAYTHLETF
RPVPFASEM
EVFPLAMNY
TAVIDHHNY
NAWNNLEKY
SALPAVTEM
HPRIITEGF
NVADVVIKF
TVAEVVETM
FTDEESRVF
EVNPNTRVM
YGFQEKEAF
YFDAIPVTM
FPATLFDAY
MPLEDMNEF
YPTEDYKVY
VPAEHQVAM
MALAVRVVY
YPNVNIHNF
EAYTDHATY
NAFEELVAF
TPITIFMEY
HAFVDLHEF
TAAAALPAF
LPFPIIQQY
FPDKPITQY
WPVGGDSRF
HPTSVISGY
TAYPGQTQY
LPLEEHYRF
LPYTVVIHY
NASRDQVVY
NAIEFMETF
EAYPDHTQF
DPFKDIILY
EAVKQYSSY
RPSVLIVTY
TAWLLYDTY
EAQPIVTKY
NVADLHEKY
HSGPVIPVY
QPYTDGVRM
TAISLFYEL
GEMVALPPV
GELLFVHSA
GEMAGAFVA
HEYPWILSA
KEMEVSPSA
MEHPYFYTV
AEYNGRLAA
RELEVQHPA
GELILTMTA
REYQELMSV
SEYIHAQVA
AEWLGVLKA
AEFARIMSI
AEYAGLKVA
GEYGGWYKA
SELAGLLSA
SEFESKVSA
KEFKEHIAA
AEIDAHLVA
GEFGGFGSV
SEFKAMDSI
AEFPSKPVA
AEFAERTVA
AEYKNWVKA
GEFTGWEKV
SELPGAFEA
AEAAVVAVA
GEIRTITVV
GEYSGIEHV
KEYDALKAA
AELQRLVAA
RELPFTKSA
GEYGKFFVT
REVQGFESA
AEFAERSVA
REMPVKVEA
REYQELMNV
AEVDAAMAA
KEYSGFAGV
GEITSSVVA
AEFGQAESA
SEITHLVNA
SEIDMSVKA
REYQDLLNV
YEVRLTQTV
YEREQVIAA
TEYSFLKEV
SEVQYIQEA
AELEKHMAA
KELEKTYSA
QEFNRLLEA
KELIFEETA
VEYESHRAA
AEYTEVKTV
HEHHTTIVA
FEQEMATAA
AEMREQYEA
AEAEGLRAA
GEIASFDKA
MEFQRFVTP
TEFPLFLQT
GEVTNVTTA
AEIIQLVNA
KEWPQTHQA
GELERALSA
SEVSKIVTV
GEHGLIIRV
HEMDRQVAA
REHLNPQAA
KELEKEYAA
AENPKLISA
RESPAQAPA
YETLTITQA
REYQELMNT
SESPVITKA
GEFQLIRQT
HESDVKIVA
IEHDVVMKA
SEVGKLLSA
EEIEGLISA
YEKDSSVAA
GETLLQRAA
IEVSLPEAA
GEFSITYKP
KEFGDQAEA
SEVEVIHVP
SEYQHQPQT
RELTNQQEA
TETDSLVSA
AEMEKQKVA
GEIGIGTPP
GEIGLGTPP
AEIAHNVSS
SEKPGSPEA
GEGKFPSAA
NEYTKFIPP
AEIEELTAS
GESNRLLSA
AEKSRTYVA
AECNAVRQA
SEFGKIYGP
AEVGPLRKA
TEVAPLKEA
ADLVFPSSA
SEADKIKVA
FEYILSHVA
AEMTTRMVA
REFSDFIRV
KEFNFPEEA
AEYGHFVDI
AEYGYIRTV
SEAEIFYNA
YEFSQRLEA
GEFEKKYVA
REVRAVTSA
HEFDEQVAA
REWVAPEKA
SEITDTVAA
AEYYRQQAA
SETVMVHQA
NEFDAIQKA
AETELINRV
YESSHIESA
AELGMEHQA
GEFVDLYVP
YESEKVGVA
REYMGFIQA
AEYPDFFAV
REFVGQLVA
SEYNMLWHA
AEHKEFITA
KENSHFFVA
REIQVQHPA
GETIALFVV
RESPFSTSA
FEFEYQTKV
AESPGVPVA
GETSVRFTA
GEFGEIEAI
QEYSEFVKA
AENVAVPEA
GEHYVHVNA
KELVIPDSA
SETSLIGTA
GEARPGPTA
AEAGGMHTV
HESAAHAIV
AETELQRAA
REIGENHEA
AELAQQRAA
EEFQFIKKA
REKAEELAA
QEHVPTSSA
GEIQEIVKT
TEVSKTPEA
FFDAELSQM
FYDERIVVV
VFDKTLAEL
HFDDTVVCL
VFDVALLDL
ILDPHVVLL
VFDEAIRAV
IFDGNVAHI
AFDVAEREF
TFDVAPSRL
IFDLGGGTF
AFDLSQVLF
VFDAFLNMM
VFDPVPVGV
SMDPLPVFL
AFDPTSTLL
FSSPHLVQV
RSAEVTLEV
KSIYPTLEI
YTTDRVMTV
KSNPIIRTV
KTIDYIQFL
ISNPIPIKV
RSVPHLQKV
FTNDKIINL
RSAAASNYV
KSIPVTQEL
RSLDHPNVL
KATAYILSV
KSIDRVLDI
SAIPYALRV
KSYAQRTEV
KTNVKFLAI
KTVNKILQI
KIMDYSLLL
YSSPEILRV
RSLQLSLVM
RTFSLFQQL
KAMELIREL
KSLERATQL
VSNDKALMV
GSYAKVLLV
ASYEFVQRL
FSNVMIHVV
VSLHHHMQV
KAYHEQLTV
VTNAVLHEV
ASAGHAVSI
KTTTIAVEV
ASTARHLYL
ASMVLPRAV
KSIKNVTEL
ASVDKVLEL
IINTHTLLL
KINEAIVAV
YGNPNTLRL
HSTDRVVLI
KVFGGFQVV
ASISLAQYL
RINAQYLEV
ASTVRILEV
RTAGPHTQF
KTGTVSLEV
VVQPQPLVV
ATYVFLHTV
KIYEGQVEV
RLNTIPLFV
FTEKSGRLL
ASFYQRALL
KSQDKTLKI
KIDDTIRYL
IANTVELRV
SSTSHVPEV
ASSEHAQMV
YTNGKCVIL
VINPTAITV
LSKGPGLEV
GAAATHLEV
RIMEKIRNV
SIIPPLFTV
QSSERPLFL
GTNFRVLLV
GSTDHIIRV
ASMVYLIRV
VMAPRTLIL
KSLLFVNTL
KSTSNITKL
KTAGPIASA
GSVDKALEL
KTQDLFRRV
TATMHILVV
QSAQHALRL
TSSSRAVVV
AINPKLLQL
KTEDKVRVM
KLNPQQFEV
KTKDGVREV
GSTTVFHSL
RSFHEVREF
VGDPVRLEV
ASIGNAQKL
GSYVFENTV
QSISVAKEV
FSEGGERLL
SILEHQIQV
ASEFGNHYL
ASTAKCLNI
QQNPRLVYV
RIYPHGLVL
ISNSHPLSL
RSHYSPIYL
ASNPKILSL
ATNPISRVL
RATHRLLLL
ATIQRIPEV
ATNPEHLEI
RTNSTFNQV
SSSSRFLEV
KAYHEQLSV
SSNAVPLKV
KAISGVHTV
ILNPYNLFL
KINEAFIEM
ASTILHLVV
RSSTYEVRL
SAQKHVLHV
LGMEHLREV
SNIDKSLYV
RSSGYPLTI
YTVPAGMTV
ATAPPHVTV
RVGDHMMFV
RTIGVMTMV
ISNNRTLEL
IVNGHTLLV
RTYQEIQEL
ATDPTIHTV
KSLSVVTEV
KTFLFSATM
KSVGKGLQV
VTNEYQHML
VTDAVALRV
ATVPGLLKV
AVNDHVLKV
ASNGSLLKV
KSFTFFNSM
KSFYDARLL
GSWDGTLRL
SIIGRLLEV
ISASSARFV
ASIQQTLKL
ASTSRSLAL
SSTAITRQV
KVIDTQQKV
GSTEKVLRV
GTNFRVLWV
ASNSEPLKL
TVTTVILEV
GSDGSTRVV
YYFEGIKQTF
KYLSVQGQLF
FYLEGGFSKF
RYFDPANGKF
VYNENLVHMI
EYPDRIMNTF
VPWHEEVVQF
LYADVGGKQF
FFDPSLLHLL
SYMLVNENRF
SYDPTIENTF
YPFKPPKITF
YPFKPPKVTF
SYASLQQNKW
VYTVVDEMFL
FPVFSDRVVY
MPVDPNEPTY
YPLEVTKLIY
FPVAGQKLIY
MPNPEGRYTF
FPHQPSALGY
HPIEGSTTVF
HPNYPYSDEY
YPFKPPKVAF
LPTEPPYTAY
HAFGGNKASY
HPWFGMEQEY
LPSPVTAQKY
HPDEKSIITY
LPLSLIFDIY
IPIERLYVTY
IPFDPKFITY
SPIPFPPLSY
SPFYPGKTTY
LPSEEEGRLY
HPISDHEATL
HPVYILKGGY
HPLSDHEATL
TAWDEADVRF
FPWGDGNHTL
SASPVSDVSY
EAMRIGAEVY
EAWASKDATY
FPFEKGSVQY
LPIGDVATQY
FPASFPNRQY
VPVSVVSDSY
HPNLVVGGTY
GEMAGAFVAV
AEMLYGLIHA
GEFRQGLISA
AEMNGKLIAA
AELYGPFTSA
AELDSVFSSA
SEVTFALHSA
RELDPSLVSA
REIQVQHPAA
GEFGTIPLVL
QEFAEGFVKA
AEWKDGLNEA
AEIEELTASA
GEIASGFWQA
GEISALTAEA
YEVRLTQTVA
GEAEAFAIGA
SEVQKGFTAA
AEAAAAVVAA
GEFGGFGSVT
AEALLHPFFA
AEIKVKLIEA
GEMMVEQRAA
HEIESLYTKL
REAEHLYHTL
AEIKMLYEQL
GEIESKFNQA
AEAILGQNAA
RELQTKINEA
RELGHGQPEA
GEFGGFGSVS
GEVGSGFKVA
SEILMQNWDA
RELQSQIQEA
AELEGALQKA
GESIDIITRA
AEIDALYKDL
GELAIKDANA
GELALKDARA
GELKTQMTSA
REMENIIATV
HEIGPSLYAA
RELTPQVVSA
SEADIRGFVA
AELADVLTEA
LETTALFVAA
GEHIATEITA
GELAGERVAA
VFDEAIRAVL
KYMPNVKVAVF
TYLPTNASLSF
VYVDLGGSHVF
VYMPASSYQSL
NYPETLGRLLI
VYSQIPAAVKL
MPVPGHDVEAY
MPVGPDAILRY
YPSRIGSIINY
MPAVKAIIYQY
WPVGGDSRFVF
LPYKATENDIY
LPYRATENDIY
NPVEDKDAVAF
APWIESQDWAY
SAAAAAAAAAY
RPFEENGACKY
MPVRGPDVEAY
YAWESSAGGSF
IPIPSTGSVEM
HAVDVDSGSVY
LPDGTSLTQTF
VPEEGGATHVY
SPVNSSKQPSY
REFLWQEGHSA
RELLIIGGVAA
AEMELQAKLTA
GEYRGSDFTAA
GEVELVSGVVA
KEAEAQLWWAA
GEYVSLGKVEA
REVSVQQQIAA
GEIPVVAIRTA
RELAQQVQQVA
REYNWNVKNKA
SEADIRGFVAA
GEMASAQYITA
SFPPPPSSGASF
YPADKISILTTY
APFEGLGKVYIY
SEVVLNTPQPSA
LPFGCSKEEIVQF
SAYGGLTSPGLSY
TPYEEGLHSVDVTY
SEMQVIEQETPVSA""".split())

line_dict = defaultdict(str)
collect_hits = set([])
for line in f_in:
    count = count + 1
    #print(count)
    cloumn1 = line.split()[0]
    if line.startswith("#"):
        continue
    if cloumn1 == "":
        continue
    if len(line.split()) > 1:
        colA = line.split()[0]
        sequence = Seq(colA, IUPAC.protein)
        for peptide in wanted:
            temp = peptide
            test_pep = Seq(peptide, IUPAC.protein)
            #print(test_pep)
            data = find_near_matches(sequence, test_pep,
            max_deletions=0, max_insertions=0, max_substitutions=0,
            max_l_dist=0)
            if data != []:
                result = "".join(["line_number: ", str(count), "\t", colA, "\t", temp])
                #if not result in collect_hits:
                out = "\t".join([str(count), colA, temp, str(data)])
                    #out = count, "\t", colA, "\t", temp, " (test peptide)", "\t", data
                collect_hits.add(result)
                line_dict[count] += out
for i in range(0, 11404):
    vals = line_dict[i]
    print(i, "\t", vals)
